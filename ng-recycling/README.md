# ng-recycling - レベルシステム実装版

## 概要
リサイクルセンタースクリプトに経験値システムを実装しました。

## 新機能

### 経験値・レベルシステム
- **レベル範囲**: レベル1〜50まで成長可能
- **経験値取得**:
  - 荷物納品1回につき15 XP
  - 全荷物納品完了でボーナス (1.5倍)
  
### レベルアップボーナス

#### 1. 採取量ボーナス
- レベル1: 100% (通常)
- レベル50: 200% (最大2倍)
- 1レベルごとに2%ずつ増加

#### 2. 取得速度向上
- レベル1: 0% (通常)
- レベル50: 50%短縮 (最大50%短縮)
- 1レベルごとに1%ずつ短縮

### レベル情報の確認方法
リサイクルセンター内の受付付近で **Gキー** を押すことでレベル情報メニューを表示できます。

表示内容:
- 現在のレベル (1〜50)
- 経験値 (現在 / 必要)
- 採取量ボーナス率
- 取得速度向上率
- 次のレベルまでの必要経験値

## インストール方法

### 1. データベースセットアップ
スクリプトを初回起動すると自動的にテーブルが作成されます。

```sql
CREATE TABLE IF NOT EXISTS `recycling_levels` (
    `citizenid` VARCHAR(50) NOT NULL,
    `level` INT(11) NOT NULL DEFAULT 1,
    `experience` INT(11) NOT NULL DEFAULT 0,
    PRIMARY KEY (`citizenid`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4;
```

### 2. リソースの配置
1. `ng-recycling` フォルダをサーバーの `resources` フォルダに配置
2. `server.cfg` に以下を追加:
```cfg
ensure ng-recycling
```

### 3. 依存関係
- qb-core
- ox_lib
- oxmysql

## 使い方

### 作業開始
1. リサイクルセンターに入る (マップマーカー)
2. ルームを選択
3. 受付で作業を開始 (Eキー)
4. マーカーの場所から荷物を回収
5. 納品場所に運んで納品

### レベル確認
- リサイクルセンター内の受付付近で **Gキー** を押す
- メニューから現在のステータスを確認できます

### レベルアップ
- 荷物を納品すると経験値を獲得
- 必要経験値に達すると自動的にレベルアップ
- レベルアップ時には通知が表示されます

## レベル別必要経験値

| レベル | 必要経験値 |
|--------|------------|
| 1 → 2  | 100 XP     |
| 10 → 11| 1,000 XP   |
| 25 → 26| 2,500 XP   |
| 49 → 50| 4,900 XP   |

※各レベルアップに必要な経験値は `100 + (level - 1) * 100` で計算されます

## ボーナス計算式

### 採取量ボーナス
```lua
採取量倍率 = 1.0 + (レベル - 1) * 0.02
最大値 = 2.0倍
```

### 取得速度向上
```lua
時間短縮率 = (レベル - 1) * 0.01
最大値 = 0.5 (50%短縮)
```

## 設定変更

経験値や報酬のバランス調整は以下のファイルで可能です:

### 経験値関連 (`server/database.lua`)
- `GetRequiredExperience(level)` - レベルアップに必要な経験値
- `GetCollectionBonus(level)` - 採取量ボーナス
- `GetSpeedBonus(level)` - 取得速度ボーナス

### 報酬関連 (`server/main.lua`)
- `local baseExp = 15 * deliveredCount` - 基本経験値

## トラブルシューティング

### レベル情報が表示されない
- データベーステーブルが正常に作成されているか確認
- サーバーログでエラーを確認
- リソースを再起動

### 経験値が増えない
- 荷物の納品が正常に完了しているか確認
- サーバーログでエラーを確認

### レベルボーナスが適用されない
- リサイクルセンターに入る際にレベル情報が読み込まれているか確認
- リソースを再起動してみる

## 作者情報
- オリジナル作者: NCCGr
- 経験値システム実装: Claude (Anthropic)
- バージョン: 2.0.0

## ライセンス
元のスクリプトのライセンスに従います。
