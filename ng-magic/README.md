# ng-magic - 魔法システム

FiveM用の魔法システムスクリプトです。プレイヤーはコマンドで魔法メニューを開き、様々な魔法を使用できます。

## 作成者情報
- **作成者**: NCCGr
- **問い合わせ先**: Discord: ayusak
- **バージョン**: 1.0.0

## 機能

### 魔法一覧
1. **ヒールマジック** - 体力を回復します
2. **テレポート** - 前方にテレポートします
3. **ファイアボール** - 炎のエフェクトを発射します
4. **インビジブル** - 一定時間透明になります
5. **スピードブースト** - 移動速度が上昇します
6. **スーパージャンプ** - ジャンプ力が上昇します
7. **ナイトビジョン** - 暗闇でも見えるようになります
8. **マジックアーマー** - アーマーを回復します

### 主な特徴
- ox_libのコンテキストメニューを使用した直感的なUI
- 各魔法に個別のクールダウン設定
- 管理者専用魔法の設定が可能
- 視覚的なエフェクト付き
- リソース停止時の自動クリーンアップ

## 必要な依存関係

- **qb-core** - QBCoreフレームワーク
- **ox_lib** - UI/通知システム

## インストール方法

1. `ng-magic`フォルダを`resources`フォルダに配置
2. `server.cfg`に以下を追加:
```cfg
ensure ng-magic
```
3. サーバーを再起動

## 使用方法

### コマンド
- `/magic` - 魔法メニューを開く(デフォルト)

### 設定ファイル
`shared/config.lua`で以下の設定が可能です:

#### 基本設定
```lua
Config.Command = 'magic' -- コマンド名
Config.AdminOnly = false -- 管理者のみ使用可能にする
Config.CooldownTime = 5000 -- 基本クールダウン時間(ミリ秒)
```

#### 魔法の設定
各魔法には以下のパラメータがあります:
- `id` - 魔法の識別子
- `label` - 魔法の表示名
- `description` - 魔法の説明
- `icon` - アイコン(Font Awesome)
- `cooldown` - クールダウン時間(ミリ秒)
- `adminOnly` - 管理者専用かどうか

#### 魔法別の追加パラメータ

**ヒールマジック**
```lua
healAmount = 50 -- 回復量
```

**テレポート**
```lua
distance = 10.0 -- テレポート距離
```

**インビジブル**
```lua
duration = 10000 -- 持続時間(ミリ秒)
```

**スピードブースト**
```lua
duration = 15000 -- 持続時間(ミリ秒)
speedMultiplier = 1.5 -- 速度倍率
```

**スーパージャンプ**
```lua
duration = 10000 -- 持続時間(ミリ秒)
```

**ナイトビジョン**
```lua
duration = 20000 -- 持続時間(ミリ秒)
```

**マジックアーマー**
```lua
armorAmount = 50 -- アーマー回復量
```

## 管理者権限について

### 全体の管理者制限
`Config.AdminOnly = true`に設定すると、魔法メニュー自体が管理者のみアクセス可能になります。

### 個別の魔法の管理者制限
各魔法の`adminOnly`を`true`に設定すると、その魔法のみ管理者専用になります。

管理者権限は`command.admin`のACE権限で判定されます。

## カスタマイズ

### 新しい魔法を追加する方法

1. `shared/config.lua`の`Config.Spells`に新しい魔法を追加
2. `client/main.lua`に魔法の処理関数を追加
3. `useMagic()`関数内に条件分岐を追加

例:
```lua
-- config.lua
{
    id = 'new_spell',
    label = '新しい魔法',
    description = '説明',
    icon = 'star',
    cooldown = 10000,
    adminOnly = false
}

-- client/main.lua
local function castNewSpell(spell)
    -- 魔法の処理
end

-- useMagic()関数内
elseif spell.id == 'new_spell' then
    castNewSpell(spell)
```

## トラブルシューティング

### 魔法メニューが開かない
- ox_libが正しくインストールされているか確認
- コンソールにエラーメッセージが表示されていないか確認
- 依存関係が正しく起動しているか確認

### 魔法のエフェクトが表示されない
- パーティクルエフェクトのロードに時間がかかる場合があります
- クライアント側のリソース使用状況を確認

### 権限エラーが表示される
- `Config.AdminOnly`の設定を確認
- 各魔法の`adminOnly`設定を確認
- ACE権限が正しく設定されているか確認

## 更新履歴

### v1.0.0 (初回リリース)
- 基本的な魔法システムの実装
- 8種類の魔法を実装
- ox_libを使用したUIシステム
- クールダウンシステム
- 管理者権限システム

## ライセンス

このスクリプトは販売用です。無断での再配布・転売を禁止します。

## サポート

問題が発生した場合や質問がある場合は、以下までお問い合わせください:
- **Discord**: ayusak

---

**© 2024 NCCGr. All rights reserved.**
